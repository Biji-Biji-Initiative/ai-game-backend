<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Backend Game Testing Tool</title>
    
    <!-- CSS styles -->
    <link rel="stylesheet" href="./style.css">
    
    <!-- Third-party libraries -->
    <script src="./js/lib/json-formatter.umd.js"></script>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="logo">
                <h1>API Tester UI</h1>
                <span id="env-indicator"></span>
            </div>
            
            <div class="status-panel" id="status-panel">
                <div class="status-indicator">
                    <span class="status-dot" id="status-dot"></span>
                    <span class="status-text" id="status-text">Loading...</span>
                </div>
                <button class="status-details-btn" id="status-details-btn">
                    <span class="details-icon">â–¾</span>
                </button>
            </div>
            
            <div class="header-controls">
                <button id="refresh-endpoints-btn" class="btn btn-secondary btn-sm">Refresh Endpoints</button>
                <button id="show-logs-btn" class="btn btn-secondary btn-sm">Show Logs</button>
                <button id="theme-toggle" class="btn btn-icon btn-sm">
                    <span class="theme-icon">ðŸŒ™</span>
                </button>
            </div>
        </header>
        
        <main class="app-main">
            <div class="flow-sidebar">
                <h2>Test Flows</h2>
                <div class="flow-menu" id="flow-menu">
                    <!-- Flows will be added here dynamically -->
                    <div class="loading">Loading flows...</div>
                </div>
            </div>
            
            <div class="content">
                <div class="flow-steps" id="flow-steps">
                    <div class="welcome-message">
                        <h2>Welcome to the AI Backend Game Testing Tool</h2>
                        <p>This tool helps you test your AI Backend Game step by step.</p>
                        <p>Select a flow from the menu on the left to begin testing.</p>
                        <ol>
                            <li>Select a flow (like "User Setup Flow")</li>
                            <li>Follow the steps in order</li>
                            <li>Fill in the required information</li>
                            <li>Click "Run This Step" to test each part</li>
                            <li>View the results and continue to the next step</li>
                        </ol>
                        <p>If you encounter any errors, helpful explanations will be provided, and all errors are automatically logged for troubleshooting.</p>
                        <p>Use the "Refresh Endpoints" button to update the available endpoints from the server.</p>
                    </div>
                </div>
                
                <div class="step-details hidden" id="step-details">
                    <div class="step-header">
                        <h2 id="step-title">Step Details</h2>
                        <span id="step-description" class="step-description"></span>
                    </div>
                    
                    <div class="step-form">
                        <div class="form-inputs" id="form-inputs">
                            <!-- Form inputs will be generated here based on the step -->
                        </div>
                        
                        <div class="form-actions">
                            <button id="run-step-btn" class="btn btn-primary">Run This Step</button>
                            <button id="clear-form-btn" class="btn">Clear Form</button>
                        </div>
                    </div>
                    
                    <div class="result-panel hidden" id="result-panel">
                        <h3>Result</h3>
                        <div class="result-status" id="result-status"></div>
                        <div class="result-content" id="result-content"></div>
                    </div>
                    
                    <!-- Variables panel -->
                    <div id="variables-panel" class="variables-panel">
                        <!-- Variable extractor will be added here -->
                    </div>
                </div>
            </div>
        </main>
        
        <div id="loading-indicator" class="loading-indicator">
            <div class="spinner"></div>
            <span>Running test...</span>
        </div>
        
        <div id="logs-panel" class="logs-panel">
            <div class="logs-header">
                <h2>Test Logs</h2>
                <div class="logs-actions">
                    <button id="refresh-backend-logs-btn" class="btn btn-secondary btn-sm">Refresh Backend Logs</button>
                    <button id="clear-logs-btn" class="btn btn-secondary btn-sm">Clear Logs</button>
                    <button id="copy-logs-btn" class="btn btn-secondary btn-sm">Copy to Clipboard</button>
                    <button id="close-logs-btn" class="btn btn-icon">âœ•</button>
                </div>
            </div>
            <div class="logs-tabs">
                <button id="frontend-logs-tab" class="logs-tab active">Frontend Logs</button>
                <button id="backend-logs-tab" class="logs-tab">Backend Logs</button>
            </div>
            <div class="logs-content" id="logs-content">
                <!-- Frontend Logs Tab -->
                <div id="frontend-logs-container" class="logs-container active">
                    <div class="logs-filter">
                        <label>
                            <input type="checkbox" id="filter-debug" checked> DEBUG
                        </label>
                        <label>
                            <input type="checkbox" id="filter-info" checked> INFO
                        </label>
                        <label>
                            <input type="checkbox" id="filter-warning" checked> WARNING
                        </label>
                        <label>
                            <input type="checkbox" id="filter-error" checked> ERROR
                        </label>
                        <input type="text" id="logs-search" placeholder="Search logs...">
                    </div>
                    <div class="logs-list" id="logs-list">
                        <!-- Logs will be populated here -->
                        <div class="empty-logs">No logs to display.</div>
                    </div>
                </div>
                
                <!-- Backend Logs Tab -->
                <div id="backend-logs-container" class="logs-container">
                    <div class="logs-filter">
                        <div class="filter-row">
                            <label>
                                <input type="checkbox" id="backend-filter-debug" checked> DEBUG
                            </label>
                            <label>
                                <input type="checkbox" id="backend-filter-info" checked> INFO
                            </label>
                            <label>
                                <input type="checkbox" id="backend-filter-warning" checked> WARNING
                            </label>
                            <label>
                                <input type="checkbox" id="backend-filter-error" checked> ERROR
                            </label>
                        </div>
                        <div class="filter-row">
                            <input type="text" id="backend-logs-search" placeholder="Search backend logs...">
                            <input type="text" id="backend-correlation-id" placeholder="Filter by correlationId">
                            <label>
                                <input type="checkbox" id="backend-auto-refresh"> Auto-refresh
                            </label>
                        </div>
                    </div>
                    <div class="logs-list" id="backend-logs-list">
                        <!-- Backend logs will be populated here -->
                        <div class="empty-logs">No backend logs to display. Click "Refresh Backend Logs" to fetch logs.</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status details modal -->
        <div class="status-modal" id="status-modal">
            <div class="status-modal-content">
                <div class="status-modal-header">
                    <h3>System Status</h3>
                    <button class="status-modal-close" id="status-modal-close">Ã—</button>
                </div>
                <div class="status-modal-body">
                    <div class="status-section">
                        <h4>Overall Status: <span id="modal-status">Loading...</span></h4>
                        <p class="status-updated">Last updated: <span id="status-last-updated">--</span></p>
                    </div>
                    
                    <div class="status-section">
                        <h4>Dependencies</h4>
                        <div class="dependency-list" id="dependency-list">
                            <div class="dependency-item skeleton"></div>
                            <div class="dependency-item skeleton"></div>
                            <div class="dependency-item skeleton"></div>
                        </div>
                    </div>
                    
                    <div class="status-section">
                        <h4>Environment</h4>
                        <div class="env-details" id="env-details">
                            <p>Mode: <span id="env-mode">--</span></p>
                            <p>Version: <span id="env-version">--</span></p>
                            <p>Node: <span id="env-node">--</span></p>
                        </div>
                    </div>
                    
                    <div class="status-actions">
                        <button id="refresh-status-btn" class="btn btn-primary">Refresh Status</button>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="app-footer">
            <p>AI Backend Game Testing Tool - All errors are automatically logged for troubleshooting</p>
        </footer>
    </div>
    
    <!-- Script files -->
    <script type="module" src="./js/main.js"></script>
</body>
</html> 